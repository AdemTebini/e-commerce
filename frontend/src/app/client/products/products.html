<section class="products-page">
	<div class="products-header">
		<h2>Nos Produits</h2>
		<button type="button" class="btn-refresh" (click)="loadProducts()">
			<span class="icon">â†»</span>
			Actualiser
		</button>
	</div>

	<div *ngIf="loading" class="loading-state">
		<div class="spinner"></div>
		<p>Chargement des produits...</p>
	</div>

	<div *ngIf="err" class="error-message">
		<span class="icon">âš </span>
		{{ err }}
	</div>

	<div *ngIf="!loading && !products.length" class="empty-state">
		<div class="empty-icon">ğŸ“¦</div>
		<p>Aucun produit disponible pour le moment.</p>
	</div>

	<div *ngIf="!loading && products.length" class="products-grid">
		<article *ngFor="let product of products" class="product-card">
			<a [routerLink]="['/products', product.id]" class="product-link">
				<div class="product-image">
					<img 
						*ngIf="product.main_image" 
						[src]="'http://localhost/ecommerce/backend/public/uploads/' + product.main_image" 
						[alt]="product.title"
						onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'"
					/>
					<img 
						*ngIf="!product.main_image" 
						src="https://via.placeholder.com/300x200?text=No+Image" 
						[alt]="product.title"
					/>
					<div class="product-badge" *ngIf="product.stock < 5 && product.stock > 0">
						Stock limitÃ©
					</div>
					<div class="product-badge out-of-stock" *ngIf="product.stock === 0">
						Ã‰puisÃ©
					</div>
					<div class="view-details-overlay">
						<span class="view-icon">ğŸ‘ï¸</span>
						<span class="view-text">Voir dÃ©tails</span>
					</div>
				</div>
				<div class="product-info">
					<h3 class="product-title">{{ product.title }}</h3>
					<p class="product-description" *ngIf="product.description">{{ product.description }}</p>
					<div class="product-footer">
						<div class="product-price">
							<span class="price-value">{{ product.price }}</span>
							<span class="price-currency">DT</span>
						</div>
						<div class="product-stock">
							<span class="stock-label">Stock:</span>
							<span class="stock-value" [class.low-stock]="product.stock < 5">{{ product.stock }}</span>
						</div>
					</div>
				</div>
			</a>
			<button 
				type="button" 
				class="btn-add-cart" 
				(click)="add(product)"
				[disabled]="product.stock === 0"
			>
				<span class="icon">ğŸ›’</span>
				{{ product.stock === 0 ? 'Indisponible' : 'Ajouter au panier' }}
			</button>
		</article>
	</div>
</section>
